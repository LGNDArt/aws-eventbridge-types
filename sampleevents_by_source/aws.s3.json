[
  {
    "version": "0",
    "id": "bfaeac7f-a57f-ddc8-2058-2e2aa99fd13d",
    "detail-type": "AWS API Call via CloudTrail",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2018-12-18T00:23:14Z",
    "region": "us-east-1",
    "resources": [],
    "detail": {
      "eventVersion": "1.05",
      "userIdentity": {
        "type": "Root",
        "principalId": "123456789012",
        "arn": "arn:aws:iam::123456789012:root",
        "accountId": "123456789012",
        "accessKeyId": "ASIA5DVXEBQOEA7B2ISB",
        "sessionContext": {
          "attributes": {
            "creationDate": "2018-12-17T23:55:39Z",
            "mfaAuthenticated": "false"
          }
        }
      },
      "eventTime": "2018-12-18T00:23:14Z",
      "eventSource": "s3.amazonaws.com",
      "eventName": "GetObjectLockLegalHold",
      "awsRegion": "us-east-1",
      "sourceIPAddress": "0.0.0.0",
      "userAgent": "[S3Console/0.4, aws-internal/3 aws-sdk-java/1.11.467 Linux/4.9.124-0.1.ac.198.73.329.metal1.x86_64 OpenJDK_64-Bit_Server_VM/25.192-b12 java/1.8.0_192]",
      "requestParameters": {
        "legal-hold": "",
        "bucketName": "bucket-with-lock",
        "key": "any_aws_health"
      },
      "responseElements": null,
      "additionalEventData": {
        "objectRetentionInfo": {
          "legalHoldInfo": {
            "isUnderLegalHold": true,
            "lastModifiedTime": 1545092274892
          }
        },
        "x-amz-id-2": "pAiOLlb/y6zpfhkP3jjWeV3mYzzEhU+QxuINK7G0F6hC/5UiulPGp7AAIUOx0I8UGp+8FrfyIng="
      },
      "requestID": "76468D5F44AF2A7E",
      "eventID": "a5c45bc2-8d9f-4c96-b273-50460a03aecc",
      "readOnly": true,
      "resources": [
        {
          "type": "AWS::S3::Object",
          "ARN": "arn:aws:s3:::bucket-with-lock/any_aws_health"
        },
        {
          "accountId": "123456789012",
          "type": "AWS::S3::Bucket",
          "ARN": "arn:aws:s3:::bucket-with-lock"
        }
      ],
      "eventType": "AwsApiCall",
      "recipientAccountId": "123456789012",
      "vpcEndpointId": "vpce-38d25651"
    }
  },
  {
    "version": "0",
    "id": "d849ee4d-a9fa-c4c9-5e9a-1ce1df6bbf9b",
    "detail-type": "AWS API Call via CloudTrail",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2018-12-18T00:23:05Z",
    "region": "us-east-1",
    "resources": [],
    "detail": {
      "eventVersion": "1.05",
      "userIdentity": {
        "type": "Root",
        "principalId": "123456789012",
        "arn": "arn:aws:iam::123456789012:root",
        "accountId": "123456789012",
        "accessKeyId": "ASIA5DVXEBQOPMMWDOUU",
        "sessionContext": {
          "attributes": {
            "creationDate": "2018-12-17T23:55:39Z",
            "mfaAuthenticated": "false"
          }
        }
      },
      "eventTime": "2018-12-18T00:23:05Z",
      "eventSource": "s3.amazonaws.com",
      "eventName": "PutObjectLockRetention",
      "awsRegion": "us-east-1",
      "sourceIPAddress": "0.0.0.0",
      "userAgent": "[S3Console/0.4, aws-internal/3 aws-sdk-java/1.11.467 Linux/4.9.124-0.1.ac.198.73.329.metal1.x86_64 OpenJDK_64-Bit_Server_VM/25.192-b12 java/1.8.0_192]",
      "errorCode": "AccessDenied",
      "errorMessage": "Access Denied",
      "requestParameters": {
        "bucketName": "bucket-with-lock",
        "retention": "",
        "key": "any_aws_health"
      },
      "responseElements": null,
      "additionalEventData": {
        "x-amz-id-2": "WJJXveXfQVfxBBw4PFBDT8VjeeUozOscEXKdZkPza7mQ1g8sOVgmnBhP5Q3AvoOfcJrYZNHBZZo="
      },
      "requestID": "249AEEFF428EFCDF",
      "eventID": "0acb0178-67c0-430f-bf56-4a9454b3e2c5",
      "readOnly": false,
      "resources": [
        {
          "type": "AWS::S3::Object",
          "ARN": "arn:aws:s3:::bucket-with-lock/any_aws_health"
        },
        {
          "accountId": "123456789012",
          "type": "AWS::S3::Bucket",
          "ARN": "arn:aws:s3:::bucket-with-lock"
        }
      ],
      "eventType": "AwsApiCall",
      "recipientAccountId": "123456789012",
      "vpcEndpointId": "vpce-38d25651"
    }
  },
  {
    "version": "0",
    "id": "3e4bfd68-4504-fee5-d557-fee0e690feac",
    "detail-type": "AWS API Call via CloudTrail",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2018-12-18T00:23:05Z",
    "region": "us-east-1",
    "resources": [],
    "detail": {
      "eventVersion": "1.05",
      "userIdentity": {
        "type": "Root",
        "principalId": "123456789012",
        "arn": "arn:aws:iam::123456789012:root",
        "accountId": "123456789012",
        "accessKeyId": "ASIA5DVXEBQOPMMWDOUU",
        "sessionContext": {
          "attributes": {
            "creationDate": "2018-12-17T23:55:39Z",
            "mfaAuthenticated": "false"
          }
        }
      },
      "eventTime": "2018-12-18T00:23:05Z",
      "eventSource": "s3.amazonaws.com",
      "eventName": "GetObjectLockRetention",
      "awsRegion": "us-east-1",
      "sourceIPAddress": "0.0.0.0",
      "userAgent": "[S3Console/0.4, aws-internal/3 aws-sdk-java/1.11.467 Linux/4.9.124-0.1.ac.198.71.329.metal1.x86_64 OpenJDK_64-Bit_Server_VM/25.192-b12 java/1.8.0_192]",
      "requestParameters": {
        "bucketName": "bucket-with-lock",
        "retention": "",
        "key": "any_aws_health"
      },
      "responseElements": null,
      "additionalEventData": {
        "objectRetentionInfo": {
          "retentionInfo": {
            "retainUntilMode": "COMPLIANCE",
            "retainUntilTime": 1545178674663,
            "lastModifiedTime": 1545092275054
          }
        },
        "x-amz-id-2": "sccghKpeGMfpoDsqt+v8puIU6/kpKxwKEnQAvjcpU+dshUnKInZUF8h0IyU9N5sdyL3JVv+7n5k="
      },
      "requestID": "154C529D52D2CDFF",
      "eventID": "aa1254b6-7ed3-4dd7-811a-0b61c193dc1e",
      "readOnly": true,
      "resources": [
        {
          "type": "AWS::S3::Object",
          "ARN": "arn:aws:s3:::bucket-with-lock/any_aws_health"
        },
        {
          "accountId": "123456789012",
          "type": "AWS::S3::Bucket",
          "ARN": "arn:aws:s3:::bucket-with-lock"
        }
      ],
      "eventType": "AwsApiCall",
      "recipientAccountId": "123456789012",
      "vpcEndpointId": "vpce-38d25651"
    }
  },
  {
    "version": "0",
    "id": "b0484f24-4f9d-3a49-de3b-e8b56b954cdd",
    "detail-type": "Object Access Tier Changed",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "size": 5,
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "NX.DRp5klxcEVaJ5RC_fO0994Hl.JHOY"
      },
      "request-id": "2MMR4GXSXJGZ5THF",
      "requester": "s3.amazonaws.com",
      "destination-access-tier": "ARCHIVE_ACCESS"
    }
  },
  {
    "version": "0",
    "id": "7382f94d-cdb4-ae90-8411-e79d33d0d2c9",
    "detail-type": "Object ACL Updated",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "Xd_29e0Da7c0h8APYtG8ZsGpnPtNDewu"
      },
      "request-id": "8NZP164VNA76D82R",
      "requester": "123456789012",
      "source-ip-address": "1.2.3.4"
    }
  },
  {
    "version": "0",
    "id": "17793124-05d4-b198-2fde-7ededc63b103",
    "detail-type": "Object Created",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "size": 5,
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "IYV3p45BT0ac8hjHg1houSdS1a.Mro8e",
        "sequencer": "00617F08299329D189"
      },
      "request-id": "N4N7GDK58NMKJ12R",
      "requester": "123456789012",
      "source-ip-address": "1.2.3.4",
      "reason": "PutObject"
    }
  },
  {
    "version": "0",
    "id": "ad1de317-e409-eba2-9552-30113f8d88e3",
    "detail-type": "Object Deleted",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "etag": "d41d8cd98f00b204e9800998ecf8427e",
        "version-id": "mtB0cV.jejK63XkRNceanNMC.qXPWLeK",
        "sequencer": "00617B398000000000"
      },
      "request-id": "20EB74C14654DC47",
      "requester": "s3.amazonaws.com",
      "reason": "Lifecycle Expiration",
      "deletion-type": "Delete Marker Created"
    }
  },
  {
    "version": "0",
    "id": "2ee9cc15-d022-99ea-1fb8-1b1bac4850f9",
    "detail-type": "Object Deleted",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "etag": "d41d8cd98f00b204e9800998ecf8427e",
        "version-id": "1QW9g1Z99LUNbvaaYVpW9xDlOLU.qxgF",
        "sequencer": "00617F0837B476E463"
      },
      "request-id": "0BH729840619AG5K",
      "requester": "123456789012",
      "source-ip-address": "1.2.3.4",
      "reason": "DeleteObject",
      "deletion-type": "Delete Marker Created"
    }
  },
  {
    "version": "0",
    "id": "6924de0d-13e2-6bbf-c0c1-b903b753565e",
    "detail-type": "Object Restore Completed",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "size": 5,
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "KKsjUC1.6gIjqtvhfg5AdMI0eCePIiT3"
      },
      "request-id": "189F19CB7FB1B6A4",
      "requester": "s3.amazonaws.com",
      "restore-expiry-time": "2021-11-13T00:00:00Z",
      "source-storage-class": "GLACIER"
    }
  },
  {
    "version": "0",
    "id": "fc79357e-5b95-4caa-d604-ea69d02c0f34",
    "detail-type": "Object Restore Expired",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "_vgOnRkretlur2Szh189LnGKvP975qk4"
      },
      "request-id": "3293B6761671D228",
      "requester": "s3.amazonaws.com"
    }
  },
  {
    "version": "0",
    "id": "ed4edb9f-fe10-a6a0-c1a3-66aa1aba83b1",
    "detail-type": "Object Restore Initiated",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "size": 5,
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "KKsjUC1.6gIjqtvhfg5AdMI0eCePIiT3"
      },
      "request-id": "5S39P9B0KSYERSCH",
      "requester": "123456789012",
      "source-ip-address": "1.2.3.4",
      "source-storage-class": "GLACIER"
    }
  },
  {
    "version": "0",
    "id": "e9a74d79-7549-f534-88d9-d2d9cd9bfd52",
    "detail-type": "Object Storage Class Changed",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "size": 5,
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "J1BDI6bMR4RgWJsmT15166nv0HhDT7zo"
      },
      "request-id": "42E9A4AA619F920B",
      "requester": "s3.amazonaws.com",
      "destination-storage-class": "GLACIER"
    }
  },
  {
    "version": "0",
    "id": "5b566166-43e6-d36e-ab5a-5083af1fda09",
    "detail-type": "Object Tags Added",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "Xd_29e0Da7c0h8APYtG8ZsGpnPtNDewu"
      },
      "request-id": "5EQMSMKAMC3Z1NH9",
      "requester": "123456789012",
      "source-ip-address": "1.2.3.4"
    }
  },
  {
    "version": "0",
    "id": "16b4a621-0c02-2315-7a02-0182de80c2df",
    "detail-type": "Object Tags Deleted",
    "source": "aws.s3",
    "account": "123456789012",
    "time": "2021-11-12T00:00:00Z",
    "region": "ca-central-1",
    "resources": [
      "arn:aws:s3:::example-bucket"
    ],
    "detail": {
      "version": "0",
      "bucket": {
        "name": "example-bucket"
      },
      "object": {
        "key": "example-key",
        "etag": "b1946ac92492d2347c6235b4d2611184",
        "version-id": "Xd_29e0Da7c0h8APYtG8ZsGpnPtNDewu"
      },
      "request-id": "FSYT108D6ZGFKMCW",
      "requester": "123456789012",
      "source-ip-address": "1.2.3.4"
    }
  }
]
